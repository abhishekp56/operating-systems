#include <stdio.h>
#include <pthread.h>
#include <semaphore.h>

sem_t f[5];

void* phil(void* n){
    int i=(int)n;
    sem_wait(&f[i]);
    sem_wait(&f[(i+1)%5]);
    printf("%d eating\n",i);
    sem_post(&f[i]);
    sem_post(&f[(i+1)%5]);
    return NULL;
}

int main(){
    pthread_t t[5];
    for(int i=0;i<5;i++) sem_init(&f[i],0,1);
    for(int i=0;i<5;i++) pthread_create(&t[i],NULL,phil,(void*)i);
    for(int i=0;i<5;i++) pthread_join(t[i],NULL);
    return 0;
}
